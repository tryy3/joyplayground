<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Joyplayground</title>
    <link rel="stylesheet" href="/playground.css">
    <link rel="stylesheet" href="/dark-theme.css">
    <link rel="stylesheet" href="/codemirror.css">
    <link rel="stylesheet" href="/popper.css">

    <script defer src="/fontawesome.js"></script>
</head>
<body>
    <input type="button" value="Run" id="embedRun">
    <div id="banner">
        <div id="head">The Joy tests</div>
        <div id="controls">
            <input type="button" value="Run" id="run">
            <input type="button" value="Format" id="fmt">
            <div id="importsBox">
                <label title="Rewrite imports on Format">
                    <input type="checkbox" id="imports">
                    Imports
                </label>
            </div>
            <div id="embedBox">
                <label id="embedLabel" title="Embed the playground">
                    <input type="checkbox" id="embed">
                    Embed
                </label>
            </div>
            <input type="button" value="Share" id="share">
            <input type="text" id="shareURL" style="display: none;">
            <input type="button" value="Dark mode" id="switchTheme">
        </div>
    </div>

    <div id="grid">
        <div class="code">
            <textarea id="code" style="display: none;">package main

import (
    "fmt"
)

func main() {
    fmt.Println("Hello, playground")
}</textarea>
        </div>
        <div id="resizableVertical" title="Drag to resize." style="display: none"></div>
        <div class="panel">
            <div id="compiled" style="display: none"></div>
            <div id="live" style="display: none"></div>
            <div id="console" style="display: none">
                <div class="editorTitle">
                    Console Output
                </div>
                <div id="output">
                    <pre></pre>
                </div>
            </div>
        </div>
        <div class="sidebar">
            <div class="sidebar-box compiled"><i data-fa-transform="down-8 right-8" class="fab fa-js-square"></i></div>
            <div class="sidebar-box live"><i data-fa-transform="down-8 right-8" class="fas fa-eye"></i></div>
            <div class="sidebar-box console"><i data-fa-transform="down-8 right-8" class="fas fa-terminal"></i></div>
        </div>
    </div>

    <script src="/playground.js"></script>
    <script src="/playground-embed.js"></script>

    <script src="/popper.min.js"></script>
    <script src="/tooltip.min.js"></script>

    <script src="/codemirror.js"></script>
    <script src="/go.js"></script>
    <script src="/javascript.js"></script>

    <script>
        API = "https://api.joyplayground.tryy3.us/api"

        if (window.location.pathname.indexOf("/p/") !== -1) {            
            $.ajax(API + window.location.pathname, {
                type: "GET",
                dataType: 'html',
                success: function(data) {
                    $("#code").html(data)
                }
            });
        }

        var code = CodeMirror.fromTextArea(document.getElementById("code"), {
            lineNumbers: true,
            mode: "go",
        });

        var compiled = CodeMirror(document.getElementById("compiled"), {
            lineNumbers: true,
            mode: "javascript",
            readOnly: true,
            value: `;(function() {
  var pkg = {};
  pkg["playground"] = (function() {
    function main () {
      console.log.apply(console.log, ["Hello, playground"])
    };
    return {
      main: main
    };
  })();
  return pkg["playground"].main();
})()`
        })

        new Editor({
            code: code,
            output: compiled,
            api: api,
            panels: [
                {
                    name: "compiled",
                    tooltip: {placement: 'left', trigger: 'hover', title: 'compiled code'},
                    editor: compiled
                },
                {
                    name: "live",
                    tooltip: {placement: 'left', trigger: 'hover', title: 'live-preview'},
                },
                {
                    name: "console",
                    tooltip: {placement: 'left', trigger: 'hover', title: 'console'},
                },
            ]
        })
    </script>
</body>
</html>