<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="/static/playground.css">
</head>
<body>
    <input type="button" value="Run" id="embedRun">
    <div id="banner">
        <div id="head">The Joy playground V2</div>
        <div id="controls">
            <input type="button" value="Run" id="run">
            <input type="button" value="Format" id="fmt">
            <div id="importsBox">
                <label title="Rewrite imports on Format">
                    <input type="checkbox" id="imports">
                    Imports
                </label>
            </div>
            <div id="embedBox">
                <label id="embedLabel" title="Embed the playground">
                    <input type="checkbox" id="embed">
                    Embed
                </label>
            </div>
            <input type="button" value="Share" id="share">
            <input type="text" id="shareURL" style="display: none;">
        </div>
    </div>

    <div id="leftWrap">
        <div class="editorTitle">
            Golang
        </div>
        <textarea itemprop="description" class="code" id="code" name="code" autocorrect="off" autocomplete="off" autocapitalize="off" spellcheck="false" style="width: 97%;" wrap="off">{{printf "%s" .Snippet}}</textarea>
    </div>
    <div id="resizableVertical" title="Drag to resize."></div>
    <div id="rightWrap">
        <div class="editorTitle">
            Javascript
        </div>
        <pre itemprop="description" class="code" id="jscode" name="jscode" autocorrect="off" autocomplete="off" autocapitalize="off" spellcheck="false" style="width: 97%;" wrap="off"></pre>
    </div>

    <div id="console">
        <div class="editorTitle">
            Console Output
        </div>
        <div id="output">
            <pre></pre>
        </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="/static/jquery-linedtextarea.js"></script>
    <script src="/static/playground.js"></script>
    <script src="/static/playground-embed.js"></script>

    <script>
        playground({
            'codeEl':       '#code',
            'jsEl':         '#jscode',
            'outputEl':     '#output',
            'runEl':        '#run, #embedRun',
            'fmtEl':        '#fmt',
            'fmtImportEl':  '#imports',
            
            'shareEl':      '#share',
            'shareURLEl':   '#shareURL',
            
            'enableHistory': true,
            'enableShortcuts': true
        });
        playgroundEmbed({
            'codeEl':       '#code',
            
            'shareEl':      '#share',
            
            'embedEl':      '#embed',
            'embedLabelEl': '#embedLabel',
            'embedHTMLEl':  '#shareURL'
        });

        $('#code').linedtextarea();
        $('#code').attr('wrap', 'off');

        $('#jscode').linedtextarea();
        $('#jscode').attr('wrap', 'off');

        var offset = 0;
        var isDragging = false;
        var lastPos = null;

        function resize() {
            var resizeWidth = $("#resizableVertical").width() - 3
            $("#leftWrap").width(($("body").width() / 2 - resizeWidth - 10 - offset) + "px")
            $("#rightWrap").width(($("body").width() / 2 - resizeWidth - 10 + offset) + "px")
            $("#resizableVertical").css("left", ($("body").width() / 2 - 10 - offset) + "px")

            $(".linedtextarea").each(function() {
                var paddingBottom = 15
                var title = $(this).siblings(".editorTitle").outerHeight()
                $(this).height(($(this).parent().height() - title - paddingBottom) + "px")
            })
        }

        $("#resizableVertical")
            .mousedown(function(e) {
                e.preventDefault()
                isDragging = true;
                lastPos = e.clientX
            })
            .mouseup(function() {
                isDragging = false;
            })
        
        $("body")
            .mousemove(function(e) {
                if (!isDragging) return
                if (e.clientX == lastPos) return
                offset = offset - (e.clientX - lastPos)
                lastPos = e.clientX
                resize()
            })

        $(window).resize(resize)
        resize()

        if (window.trackEvent) {
            $('#run').click(function() {
                window.trackEvent('playground', 'click', 'run-button');
            });
            $('#share').click(function() {
                window.trackEvent('playground', 'click', 'share-button');
            });
        }
    </script>
</body>
</html>